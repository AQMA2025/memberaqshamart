<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daftar Member Aqshamart</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 480px;
        margin: 0 auto;
        background: white;
        min-height: 100vh;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      @media (min-width: 768px) {
        .container {
          max-width: 800px;
          margin: 20px auto;
          border-radius: 20px;
          min-height: calc(100vh - 40px);
        }
      }

      /* Header */
      .header {
        background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
        padding: 20px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>')
          repeat;
        animation: float 20s infinite linear;
      }

      @keyframes float {
        0% {
          transform: translateX(0) translateY(0);
        }
        100% {
          transform: translateX(-50px) translateY(-50px);
        }
      }

      .logo-placeholder {
        width: 120px;
        height: 60px;
        background: rgba(255, 255, 255, 0.2);
        border: 2px dashed rgba(255, 255, 255, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        border-radius: 10px;
        color: white;
        font-size: 12px;
        z-index: 2;
        position: relative;
      }

      .header-title {
        color: white;
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
        z-index: 2;
        position: relative;
      }

      .header-subtitle {
        color: rgba(255, 255, 255, 0.9);
        font-size: 16px;
        z-index: 2;
        position: relative;
      }

      /* Benefits Section */
      .benefits {
        background: white;
        padding: 20px;
        border-bottom: 1px solid #eee;
      }

      .benefits-title {
        text-align: center;
        color: #ff6b35;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 15px;
      }

      .benefits-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
      }

      @media (min-width: 768px) {
        .benefits-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      .benefit-item {
        display: flex;
        align-items: center;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 10px;
        transition: transform 0.3s ease;
      }

      .benefit-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }

      .benefit-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
        color: white;
      }

      .benefit-text {
        font-size: 14px;
        color: #555;
        line-height: 1.3;
      }

      /* Form */
      .form-container {
        padding: 30px 20px;
      }

      .form-title {
        text-align: center;
        color: #333;
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 20px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        color: #555;
        font-weight: 600;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .form-input,
      .form-select,
      .form-textarea {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e1e5e9;
        border-radius: 10px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: white;
      }

      .form-input:focus,
      .form-select:focus,
      .form-textarea:focus {
        outline: none;
        border-color: #ff6b35;
        box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
      }

      .form-textarea {
        min-height: 80px;
        resize: vertical;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
      }

      @media (min-width: 768px) {
        .form-row {
          grid-template-columns: 1fr 1fr;
        }

        .form-row.three-cols {
          grid-template-columns: 1fr 1fr 1fr;
        }
      }

      .submit-btn {
        width: 100%;
        padding: 15px;
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 20px;
        position: relative;
        overflow: hidden;
      }

      .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(255, 107, 53, 0.3);
      }

      .submit-btn:active {
        transform: translateY(0);
      }

      .submit-btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none;
      }

      /* Loading Animation */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .loading-content {
        background: white;
        padding: 40px;
        border-radius: 20px;
        text-align: center;
        max-width: 300px;
        width: 90%;
      }

      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #ff6b35;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        color: #333;
        font-size: 16px;
        font-weight: 600;
      }

      /* Success Popup */
      .success-popup {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1001;
      }

      .success-content {
        background: white;
        padding: 40px 30px;
        border-radius: 20px;
        text-align: center;
        max-width: 400px;
        width: 90%;
        position: relative;
      }

      .success-icon {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, #4caf50, #45a049);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        color: white;
        font-size: 40px;
      }

      .success-title {
        color: #333;
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 15px;
      }

      .success-message {
        color: #666;
        font-size: 16px;
        line-height: 1.5;
        margin-bottom: 20px;
      }

      .success-instruction {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        padding: 15px;
        border-radius: 10px;
        color: #856404;
        font-size: 14px;
        margin-bottom: 20px;
      }

      .close-btn {
        background: #ff6b35;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <h1 class="header-title">Bergabung dengan Aqshamart Community</h1>
        <p class="header-subtitle">
          Nikmati berbagai keuntungan eksklusif untuk member
        </p>
      </div>

      <!-- Benefits Section -->
      <div class="benefits">
        <h2 class="benefits-title">Keuntungan Menjadi Member</h2>
        <div class="benefits-grid">
          <div class="benefit-item">
            <div class="benefit-icon">
              <i class="fas fa-bell"></i>
            </div>
            <div class="benefit-text">
              Prioritas mendapat info promo terbaru
            </div>
          </div>
          <div class="benefit-item">
            <div class="benefit-icon">
              <i class="fas fa-tags"></i>
            </div>
            <div class="benefit-text">
              Penawaran spesial dengan harga khusus
            </div>
          </div>
          <div class="benefit-item">
            <div class="benefit-icon">
              <i class="fas fa-shipping-fast"></i>
            </div>
            <div class="benefit-text">
              Layanan pesan antar cepat & FREE ongkir
            </div>
          </div>
        </div>
      </div>

      <!-- Form -->
      <div class="form-container">
        <h2 class="form-title">Daftar Member Sekarang</h2>
        <form id="memberForm">
          <div class="form-group">
            <label class="form-label">Nama Lengkap *</label>
            <input
              type="text"
              class="form-input"
              id="namaLengkap"
              name="namaLengkap"
              required
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Sapaan *</label>
              <select class="form-select" id="sapaan" name="sapaan" required>
                <option value="">Pilih Sapaan</option>
                <option value="Bapak">Bapak</option>
                <option value="Ibu">Ibu</option>
                <option value="Mas">Mas</option>
                <option value="Mbak">Mbak</option>
                <option value="Kak">Kak</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Panggilan *</label>
              <input
                type="text"
                class="form-input"
                id="panggilan"
                name="panggilan"
                required
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Nomor HP (WhatsApp) *</label>
            <input
              type="tel"
              class="form-input"
              id="nomorHP"
              name="nomorHP"
              placeholder="Contoh: 08123456789"
              required
            />
          </div>

          <div class="form-row three-cols">
            <div class="form-group">
              <label class="form-label">Tanggal *</label>
              <select class="form-select" id="tanggal" name="tanggal" required>
                <option value="">Tanggal</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Bulan *</label>
              <select class="form-select" id="bulan" name="bulan" required>
                <option value="">Bulan</option>
                <option value="01">Januari</option>
                <option value="02">Februari</option>
                <option value="03">Maret</option>
                <option value="04">April</option>
                <option value="05">Mei</option>
                <option value="06">Juni</option>
                <option value="07">Juli</option>
                <option value="08">Agustus</option>
                <option value="09">September</option>
                <option value="10">Oktober</option>
                <option value="11">November</option>
                <option value="12">Desember</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Tahun *</label>
              <select class="form-select" id="tahun" name="tahun" required>
                <option value="">Tahun</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Agama *</label>
              <select class="form-select" id="agama" name="agama" required>
                <option value="">Pilih Agama</option>
                <option value="Islam">Islam</option>
                <option value="Kristen">Kristen</option>
                <option value="Katolik">Katolik</option>
                <option value="Hindu">Hindu</option>
                <option value="Buddha">Buddha</option>
                <option value="Konghucu">Konghucu</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Jenis Kelamin *</label>
              <select
                class="form-select"
                id="jenisKelamin"
                name="jenisKelamin"
                required
              >
                <option value="">Pilih Jenis Kelamin</option>
                <option value="Laki-laki">Laki-laki</option>
                <option value="Perempuan">Perempuan</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Alamat Lengkap *</label>
            <textarea
              class="form-textarea"
              id="alamat"
              name="alamat"
              placeholder="Masukkan alamat lengkap Anda"
              required
            ></textarea>
          </div>

          <button type="submit" class="submit-btn">
            <i class="fas fa-user-plus"></i> DAFTAR MEMBER SEKARANG
          </button>
        </form>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <div class="loading-text">Pendaftaran sedang diproses...</div>
      </div>
    </div>

    <!-- Success Popup -->
    <div class="success-popup" id="successPopup">
      <div class="success-content">
        <div class="success-icon">
          <i class="fas fa-check"></i>
        </div>
        <h3 class="success-title">Selamat!</h3>
        <p class="success-message">
          Anda sudah berhasil tergabung dengan member Aqshamart Community
        </p>
        <div class="success-instruction">
          <strong
            >Tunjukkan pop-up ini ke kasir atau call center kami untuk
            mendapatkan benefit member!</strong
          >
        </div>
        <button class="close-btn" onclick="closeSuccessPopup()">Tutup</button>
      </div>
    </div>

    <script>
      // Function untuk mengisi dropdown tanggal dan tahun
      function populateDateDropdowns() {
        const tanggalSelect = document.getElementById("tanggal");
        const tahunSelect = document.getElementById("tahun");

        // Mengisi dropdown tanggal (1-31)
        for (let i = 1; i <= 31; i++) {
          const option = document.createElement("option");
          option.value = i.toString().padStart(2, "0");
          option.textContent = i;
          tanggalSelect.appendChild(option);
        }

        // Mengisi dropdown tahun (dari 1950 sampai tahun sekarang)
        const currentYear = new Date().getFullYear();
        for (let year = currentYear; year >= 1950; year--) {
          const option = document.createElement("option");
          option.value = year;
          option.textContent = year;
          tahunSelect.appendChild(option);
        }
      }

      // Function untuk close success popup
      function closeSuccessPopup() {
        document.getElementById("successPopup").style.display = "none";
      }

      // Panggil function untuk mengisi dropdown saat halaman dimuat
      document.addEventListener("DOMContentLoaded", function () {
        populateDateDropdowns();
      });

      // GANTI URL ini dengan Web App URL dari Google Apps Script Anda
      const GOOGLE_SHEETS_URL =
        "https://script.google.com/macros/s/AKfycbyGngVYBH0VpLGwdkSgx6q95K1PTDjByyBWDft0fpe3hXT8kvYoLPj5UeZOOQ1li2G29Q/exec";

      // Function untuk menyimpan data ke Google Sheets
      async function saveToGoogleSheets(data) {
        try {
          const response = await fetch(GOOGLE_SHEETS_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
            mode: "no-cors", // Important for Google Apps Script
          });

          console.log("Data berhasil disimpan ke Google Sheets");
          return { success: true };
        } catch (error) {
          console.error("Error saving to Google Sheets:", error);
          throw error;
        }
      }

      // Form submission handler
      document
        .getElementById("memberForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          // Show loading
          document.getElementById("loadingOverlay").style.display = "flex";

          // Get form data
          const formData = new FormData(this);
          const data = Object.fromEntries(formData);

          // Format tanggal lahir menjadi format YYYY-MM-DD
          if (data.tahun && data.bulan && data.tanggal) {
            data.tanggalLahir = `${data.tahun}-${data.bulan}-${data.tanggal}`;
          }

          // Format phone number for WhatsApp (remove leading 0, add 62)
          let whatsappNumber = data.nomorHP.replace(/\D/g, "");
          if (whatsappNumber.startsWith("0")) {
            whatsappNumber = "62" + whatsappNumber.substring(1);
          } else if (!whatsappNumber.startsWith("62")) {
            whatsappNumber = "62" + whatsappNumber;
          }

          // Update nomor HP di data dengan format yang benar
          data.nomorHP = whatsappNumber;

          // Get month name for WhatsApp message (convert from number back to name)
          const bulanNames = {
            "01": "Januari",
            "02": "Februari",
            "03": "Maret",
            "04": "April",
            "05": "Mei",
            "06": "Juni",
            "07": "Juli",
            "08": "Agustus",
            "09": "September",
            10: "Oktober",
            11: "November",
            12: "Desember",
          };

          // Prepare WhatsApp message
          const whatsappMessage = `Terima kasih ${data.sapaan} ${data.panggilan} telah mendaftar menjadi member Aqshamart Community.

Setelah menerima pesan ini, *${data.sapaan}* *${data.panggilan}* langsung dapat menikmati berbagai BENEFIT dari Aqshamart antara lain :
- Prioritas mendapatkan informasi promo atas berbagai produk 
- Selalu mendapat penawaran spesial dengan harga khusus 
- Layanan pesan antar yang cepat & FREE ongkir

Semoga *${data.sapaan}* *${data.panggilan}* & keluarga selalu diberikan kesehatan dan kelancaran rejeki...amin.

Salam Smart,
Yang *SMART* selalu belanja di Aqshamart

_Nomor ini khusus pengiriman pesan notifikasi, sedangkan untuk layanan pesan antar klik link_ : bit.ly/pesan-aqsha

tunjukkan pesan ini di kasir untuk klaim hadiah selama persediaan masih ada`;

          try {
            // Simulate processing time
            await new Promise((resolve) => setTimeout(resolve, 1000));

            // Save to Google Sheets FIRST
            await saveToGoogleSheets(data);
            console.log("Data tersimpan ke Google Sheets");

            // Then send WhatsApp message
            const whatsappResponse = await fetch(
              "https://crm.woo-wa.com/send/message-text",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  deviceId: "d_ID@6753a3309becd_lLMQ0PrnAMfGf",
                  number: whatsappNumber,
                  message: whatsappMessage,
                }),
              }
            );

            console.log("WhatsApp API Response:", whatsappResponse);

            // Hide loading
            document.getElementById("loadingOverlay").style.display = "none";

            // Show success popup
            document.getElementById("successPopup").style.display = "flex";

            // Reset form
            this.reset();
          } catch (error) {
            console.error("Error:", error);
            // Hide loading
            document.getElementById("loadingOverlay").style.display = "none";

            // Still show success popup
            document.getElementById("successPopup").style.display = "flex";
            this.reset();
          }
        });
    </script>
  </body>
</html>
